+document-section('JavaScript Examples')
  style.
    .guide-columnview-js-example {
      height: 400px;
      position: relative;
    }
  p.
    The following examples demonstrate usage of the JavaScript API's for #{component.displayName}.

  +document-subsection('JS Class Initialization')
  p.
    The following is an example of the ColumnView, which is manually initialized on page
    initialization, added to the DOM and navigates via the coral-columnview:loaditems event.

  #constructorExample.guide-columnview-js-example.
    <script>
      $(document).ready(function() {
        var columnView = new Coral.ColumnView().set({
          id: 'guide-columnView-multiple-0',
          selectionMode: 'multiple'
        });
        var columnViewColumn = new Coral.ColumnView.Column().set({
          id: 'guide-columnViewColumn-multiple-0'
        })
        // Add the data-src attribute, which is red in the loaditems event-listener
        columnViewColumn.setAttribute('data-src', 'resources/columnview/content.html');
        columnView.appendChild(columnViewColumn);

        var constructorExample = document.getElementById('constructorExample');
        constructorExample.appendChild(columnView);
      });
    </script>
  p.
    Notice: The individual columns and preview are loaded from html snippets.

  +example-pre-only('constructorExample')

  +document-subsection('Loading remote data')
  p.
    The following shows how to listen for the coral-columnview:loaditems event and use setNextColumn.

  +example-pre-only().
      <script>
        $(document).ready(function() {
          var eventLog = $('#columnViewLog');

          document.addEventListener('coral-columnview:loaditems', function(event) {
            var cv = event.target;
            var item = event.detail.item;
            var column = event.detail.column;

            // if item is set, it means we load the item content
            var url = item ? $(item).attr('data-src') : $(column).attr('data-src');

            // there is no information on additional items
            if (typeof url === 'undefined') {
              return;
            }

            console.log('Loading: %s', url);

            $.ajax({
              url: url
            }).done(function(data) {
              var $data = $(data);

              // if it is a preview column we add it directly
              if ($data.is('coral-columnview-preview')) {
                cv.setNextColumn($data[0], column);
              }
              else {
                // otherwise we treat it as a normal column
                var $contentWrapper = $data.find('coral-columnview-column-content').first();
                var $columnWrapper = $contentWrapper.closest('coral-columnview-column');

                if ($contentWrapper.length > 0) {
                  if (item) {
                    // adds an unique id to be able to identify the column
                    $data[0].id = Coral.commons.getUID();
                    // we add the new column and scroll to it
                    cv.setNextColumn($data[0], column);
                  }
                  // we load data in the current column
                  else {
                    // update the source of the current column (so that lazyloading does work)
                    var nextSrcToLoad = $($columnWrapper).attr('data-src');
                    if (!nextSrcToLoad) {
                      column.removeAttribute('data-src');
                    }
                    else {
                      column.setAttribute('data-src', nextSrcToLoad);
                    }

                    // update the content
                    $(column.content).append($contentWrapper.html());
                  }
                }
              }
            });
          });
        });
      </script>


  +document-subsection('Responding to user interaction')
    p.
      The following shows how to listen for events generated by the ColumnView above.

    +example-pre-only().
      <script>
        $(document).ready(function() {
          var eventLog = $('#columnViewLog');
          var columnView = document.getElementById('guide-columnView-multiple-0');
          columnView.on('coral-columnview:change', function(e) {
            eventLog.log(e.type);
          });
          columnView.on('coral-columnview:loaditems', function(e) {
            eventLog.log(e.type + ' ' + ' start: ' + event.detail.start + ' column: ' + event.detail.column.id);
          });
          columnView.on('coral-columnview:activeitemchange', function(e) {
            var logMessage = e.type + ' new: "' + $(event.detail.activeItem).text() + '" old: "' + $(event.detail.oldActiveItem).text();
            eventLog.log(logMessage);
          });
        });
      </script>
    +log('columnViewLog')
