<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>coral-Checkbox examples</title>

  <link rel="stylesheet" href="../../css/coral.css">
  <script src="../../js/libs/jquery.js"></script>
  <!-- typekit is needed for proper fonts -->
  <script src="../../js/typekit.js"></script>

  <style type="text/css">
    ul {
      list-style: none;
      -webkit-padding-start: 20px;
    }

    body {
      padding: 15px;
    }

    .col {
      float: left;
      margin-right: 12px;
      width: 500px;
    }

    .col > section {
      padding: 10px;
    }
  </style>

  <script>
  $(function () {

    /**
     Inspired by http://css-tricks.com/indeterminate-checkboxes/
     with added support for the WAI-ARIA aria-checked property
     which properly communicates the state to assistive technology.
    */
    $(':checkbox, input[role="checkbox"]')
      .each(function () {
      var $checkbox = $(this),
        checked = this.checked = $checkbox.is('[checked]'); // explicitly set "checked" property for elements with checked attribute

      // Add aria-checked and checked attribute
      $checkbox.attr({
        'role': 'checkbox',
        'aria-checked': $checkbox.attr('aria-checked') || checked,
        'checked': checked
      });
    });

    /**
     * Respond to change event and update state of parent or child checkboxes accordingly.
     */
      $(':checkbox, input[role="checkbox"]').change(function () {
        var checked = this.checked,
          container = $(this).parent(),
          siblings = container.siblings();

        container.find(':checkbox, input[role="checkbox"]').prop({
          indeterminate: false,
       checked: checked
        }).attr({
          'aria-checked': checked,
          'checked': checked
        });

        function checkSiblings(el) {
          var parent = el.parent().parent(),
            all = true;

          el.siblings().each(function () {
            return all = ($(this).children(':checkbox, input[role="checkbox"]').prop("checked") === checked);
          });

          if (all && checked) {
            parent.children(':checkbox, input[role="checkbox"]').prop({
              indeterminate: false,
           checked: checked
            }).attr({
              'aria-checked': checked,
              'checked': checked
            });
            checkSiblings(parent);
          } else if (all && !checked) {
            parent.children(':checkbox, input[role="checkbox"]').attr({
              'aria-checked': checked,
              'checked': checked
            }).prop({
        indeterminate: (parent.find(':checkbox:checked, input[role="checkbox"]:checked').length > 0),
        checked: checked
       });
            checkSiblings(parent);
          } else {
            el.parents("li").children(':checkbox, input[role="checkbox"]').prop({
              indeterminate: true,
         checked: false
            }).attr({
              'aria-checked': 'mixed',
              'checked': false
            });
          }
        }
        checkSiblings(container);
      });

    /**
     * Makes a checkbox cycle through the different states.
     */
    $('#vtest-cycle-checkbox').off('change').click(function (e) {
      var ariaChecked = $(this).attr('aria-checked');
      if (ariaChecked === 'mixed') {
        this.indeterminate = this.checked = false;
      } else {
        this.indeterminate = (ariaChecked === 'true');
        this.checked = !this.indeterminate;
      }
      $(this).attr({
        'aria-checked': this.indeterminate ? 'mixed' : this.checked,
        'checked': this.checked
      });
      if (!('ontouchstart' in window)) $(this).focus();
    });
  });
</script>
</head>
<body class="coral--light">
  <h1>coral-Checkbox</h1>
  <div class="col">
    <section>
      <form>
        <h2>Checked, unchecked and mixed state checkboxes</h2>

        <div id="vtest-checkbox-group">
          <label class="coral-Checkbox coral-Label">
            <input class="coral-Checkbox-input" id="vtest-checked-checkbox" type="checkbox" name="c1" value="1" checked>
            <span class="coral-Checkbox-description">Checked</span>
          </label>
          <br>
          <label class="coral-Checkbox coral-Label">
            <input class="coral-Checkbox-input" id="vtest-unchecked-checkbox" type="checkbox" name="c2" value="2">
            <span class="coral-Checkbox-description">Unchecked</span>
          </label>
          <br>
          <label class="coral-Checkbox coral-Label">
            <input class="coral-Checkbox-input" id="vtest-partial-checkbox" type="checkbox"  name="c3" value="3" aria-checked="mixed">
            <span class="coral-Checkbox-description">Partially checked</span>
          </label>
          <br>
          <label class="coral-Checkbox coral-Label">
            <input class="coral-Checkbox-input" id="vtest-cycle-checkbox" type="checkbox" name="c4" value="4">
            <span class="coral-Checkbox-description">Cycling state checkbox</span>
          </label>
          <br>
          <label class="coral-Checkbox coral-Label">
            <input id="checked-checkbox-disabled" class="coral-Checkbox-input" type="checkbox" name="c5" value="5" disabled="disabled" checked>
            <span class="coral-Checkbox-description">Disabled Checked</span>
          </label>
          <br>
          <label class="coral-Checkbox coral-Label">
            <input id="unchecked-checkbox-disabled" class="coral-Checkbox-input" type="checkbox" name="c6" value="6" disabled="disabled">
            <span class="coral-Checkbox-description">Disabled Unchecked</span>
          </label>
          <br>
          <label class="coral-Checkbox coral-Label">
            <input id="some-checkbox2" type="checkbox" class="coral-Checkbox-input" name="c7" value="7" disabled="disabled" aria-checked="mixed">
            <span class="coral-Checkbox-description">Disabled Partially Checked</span>
          </label>
        </div>

        <h2>Nested coral-Checkboxes</h2>
        <p>
          With additional javascript it is possible to next the checkboxes.
        </p>
        <div id="vtest-checkbox-nested-group">
          <ul>
            <li class="coral-Checkbox">
              <input type="checkbox" name="tall" id="tall" class="coral-Checkbox-input">
              <label for="tall" class="coral-Checkbox-description coral-Label">Tall Things</label>

              <ul>
                <li class="coral-Checkbox">
                  <input type="checkbox" name="tall-1" id="tall-1" class="coral-Checkbox-input">
                  <label for="tall-1" class="coral-Checkbox-description coral-Label">Buildings</label>
                </li>
                <li class="coral-Checkbox">
                  <input type="checkbox" name="tall-2" id="tall-2" class="coral-Checkbox-input">
                  <label for="tall-2" class="coral-Checkbox-description coral-Label">Giants</label>
                  <ul>
                    <li class="coral-Checkbox">
                      <input type="checkbox" name="tall-2-1" id="tall-2-1" class="coral-Checkbox-input">
                      <label for="tall-2-1" class="coral-Checkbox-description coral-Label">Andre</label>
                    </li>
                    <li class="coral-Checkbox">
                      <input type="checkbox" name="tall-2-2" id="tall-2-2" class="coral-Checkbox-input">
                      <label for="tall-2-2" class="coral-Checkbox-description coral-Label">Paul Bunyan</label>
                    </li>
                  </ul>
                </li>
                <li class="coral-Checkbox">
                  <input type="checkbox" name="tall-3" id="tall-3" class="coral-Checkbox-input">
                  <label for="tall-3" class="coral-Checkbox-description coral-Label">Two sandwiches</label>
                </li>
              </ul>
            </li>
            <li id="vtest-checks-2" class="coral-Checkbox">
              <input type="checkbox" name="short" id="short" class="coral-Checkbox-input">
              <label for="short" class="coral-Checkbox-description coral-Label">Short Things</label>

              <ul>
                <li class="coral-Checkbox">
                  <input type="checkbox" name="short-1" id="short-1" class="coral-Checkbox-input">
                  <label for="short-1" class="coral-Checkbox-description coral-Label">Smurfs</label>
                </li>
                <li class="coral-Checkbox">
                  <input type="checkbox" name="short-2" id="short-2" class="coral-Checkbox-input">
                  <label for="short-2" class="coral-Checkbox-description coral-Label">Mushrooms</label>
                </li>
                <li class="coral-Checkbox">
                  <input type="checkbox" name="short-3" id="short-3" class="coral-Checkbox-input">
                  <label for="short-3" class="coral-Checkbox-description coral-Label">One Sandwich</label>
                </li>
              </ul>
            </li>
          </ul>
          <button type="submit" class="coral-Button">Submit</button>
        </div>
      </form>
    </section>
  </div>

  <div class="col">
    <section id="vtest-checkbox-dark-group" class="coral--dark coral-Well">
      <h2>Checked and unchecked checkboxes</h2>
      <form>
        <label class="coral-Checkbox coral-Label">
          <input class="coral-Checkbox-input" type="checkbox" name="c1" checked>
          <span class="coral-Checkbox-description">Checked</span>
        </label>
        <br>
        <label class="coral-Checkbox coral-Label">
          <input class="coral-Checkbox-input" type="checkbox" name="c2" >
          <span class="coral-Checkbox-description">Unchecked</span>
        </label>
        <br>
        <label class="coral-Checkbox coral-Label">
          <input class="coral-Checkbox-input" type="checkbox" name="c3" disabled="" >
          <span class="coral-Checkbox-description">Unchecked Disabled</span>
        </label>
        <br>
        <label class="coral-Checkbox coral-Label">
          <input class="coral-Checkbox-input" type="checkbox" name="c1" checked disabled="">
          <span class="coral-Checkbox-description">Checked Disabled</span>
        </label>
        <br></form>
    </section>
  </div>

  <script type="text/javascript">
  $('#some-checkbox').prop('indeterminate', true);
  $('#some-checkbox2').prop('indeterminate', true);
</script>
</body>
</html>
