<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Coral.Autocomplete</title>

  <link rel="stylesheet" href="../build/css/coral.css">
  <script src="../build/js/coral.js"></script>

  <style>
    section {
      padding: 15px;
    }
  </style>

</head>
<body class="coral--light">
  <div style="position:fixed;top:15px;right:15px;">
    <a href="#" class="coral-Link" onclick="event.preventDefault();document.body.className='coral--light'">Light</a> |
    <a href="#" class="coral-Link" onclick="event.preventDefault();document.body.className='coral--lightest'">Lightest</a> |
    <a href="#" class="coral-Link" onclick="event.preventDefault();document.body.className='coral--dark'">Dark</a> |
    <a href="#" class="coral-Link" onclick="event.preventDefault();document.body.className='coral--darkest'">Darkest</a>
  </div>

  <section>
    <h1 class="coral-Heading coral-Heading--1">Coral.Autocomplete</h1>

    <h2 class="coral-Heading coral-Heading--2">Default</h2>
    <coral-autocomplete>
      <coral-autocomplete-item value="ch">Chrome</coral-autocomplete-item>
      <coral-autocomplete-item value="fi">Firefox</coral-autocomplete-item>
      <coral-autocomplete-item value="ie">Internet Explorer</coral-autocomplete-item>
      <coral-autocomplete-item value="op">Opera</coral-autocomplete-item>
      <coral-autocomplete-item value="sa">Safari</coral-autocomplete-item>
    </coral-autocomplete>

    <h2 class="coral-Heading coral-Heading--2">Quiet variant</h2>
    <coral-autocomplete variant="quiet">
      <coral-autocomplete-item value="ch">Chrome</coral-autocomplete-item>
      <coral-autocomplete-item value="fi">Firefox</coral-autocomplete-item>
      <coral-autocomplete-item value="ie">Internet Explorer</coral-autocomplete-item>
      <coral-autocomplete-item value="op">Opera</coral-autocomplete-item>
      <coral-autocomplete-item value="sa">Safari</coral-autocomplete-item>
    </coral-autocomplete>

    <h2 class="coral-Heading coral-Heading--2">With forced selection</h2>
    <coral-autocomplete forceselection>
      <coral-autocomplete-item value="ch">Chrome</coral-autocomplete-item>
      <coral-autocomplete-item value="fi">Firefox</coral-autocomplete-item>
      <coral-autocomplete-item value="ie">Internet Explorer</coral-autocomplete-item>
      <coral-autocomplete-item value="op">Opera</coral-autocomplete-item>
      <coral-autocomplete-item value="sa">Safari</coral-autocomplete-item>
    </coral-autocomplete>

    <h2 class="coral-Heading coral-Heading--2">With multiple selection</h2>
    <coral-autocomplete multiple>
      <coral-autocomplete-item value="ch">Chrome</coral-autocomplete-item>
      <coral-autocomplete-item value="fi">Firefox</coral-autocomplete-item>
      <coral-autocomplete-item value="ie">Internet Explorer</coral-autocomplete-item>
      <coral-autocomplete-item value="op">Opera</coral-autocomplete-item>
      <coral-autocomplete-item value="sa">Safari</coral-autocomplete-item>
    </coral-autocomplete>

    <h2 class="coral-Heading coral-Heading--2">With remote loading</h2>
    <coral-autocomplete id="autocomplete" delay="50" multiple></coral-autocomplete>

    <h2 class="coral-Heading coral-Heading--2">ReadOnly</h2>
    <coral-autocomplete readonly>
      <coral-autocomplete-item selected value="ch">Chrome</coral-autocomplete-item>
      <coral-autocomplete-item value="fi">Firefox</coral-autocomplete-item>
      <coral-autocomplete-item value="ie">Internet Explorer</coral-autocomplete-item>
      <coral-autocomplete-item value="op">Opera</coral-autocomplete-item>
      <coral-autocomplete-item value="sa">Safari</coral-autocomplete-item>
    </coral-autocomplete>

    <h2 class="coral-Heading coral-Heading--2">Disabled</h2>
    <coral-autocomplete disabled>
      <coral-autocomplete-item value="ch">Chrome</coral-autocomplete-item>
      <coral-autocomplete-item value="fi">Firefox</coral-autocomplete-item>
      <coral-autocomplete-item value="ie">Internet Explorer</coral-autocomplete-item>
      <coral-autocomplete-item value="op">Opera</coral-autocomplete-item>
      <coral-autocomplete-item value="sa">Safari</coral-autocomplete-item>
    </coral-autocomplete>

    <h2 class="coral-Heading coral-Heading--2">Invalid</h2>
    <coral-autocomplete invalid>
      <coral-autocomplete-item value="ch">Chrome</coral-autocomplete-item>
      <coral-autocomplete-item value="fi">Firefox</coral-autocomplete-item>
      <coral-autocomplete-item value="ie">Internet Explorer</coral-autocomplete-item>
      <coral-autocomplete-item value="op">Opera</coral-autocomplete-item>
      <coral-autocomplete-item value="sa">Safari</coral-autocomplete-item>
    </coral-autocomplete>

    <h2 class="coral-Heading coral-Heading--2">Form Field</h2>
    <form class="coral-Form coral-Form--vertical" style="max-width:300px;">
      <label id="label" class="coral-FieldLabel">Label</label>
      <coral-autocomplete class="coral-Form-field" labelledby="label">
        <coral-autocomplete-item value="ch">Chrome</coral-autocomplete-item>
        <coral-autocomplete-item value="fi">Firefox</coral-autocomplete-item>
        <coral-autocomplete-item value="ie">Internet Explorer</coral-autocomplete-item>
        <coral-autocomplete-item value="op">Opera</coral-autocomplete-item>
        <coral-autocomplete-item value="sa">Safari</coral-autocomplete-item>
      </coral-autocomplete>
    </form>
  </section>

  <script>
    // Mocked server interaction
    window.fakejax = function(url, data, callback) {
      var requestTimeout = setTimeout(function() {
        // Filter the suggestions according to the user input
        // This would run on the server, effectively
        var suggestions = [];

        for (var i = 0; i < 10; i++) {
          var number = i + data.start;
          suggestions.push({
            value: number,
            content: 'Item '+number
          });
        }

        callback(suggestions);
      }, 500);

      return {
        abort: function() {
          // Stop previous request
          clearTimeout(requestTimeout);
        }
      };
    };

    var autocomplete = document.getElementById('autocomplete');

    var request;
    autocomplete.on('coral-autocomplete:showsuggestions', function(event) {
      // If a previous request was started, abort it
      if (request) {
        request.abort();
      }

      // Don't show suggestions from existing items
      // This shows a loading icon until we call addSuggestions
      event.preventDefault();

      // Get the user input as lowercase
      var userInput = event.detail.value.toLowerCase();
      var startRecord = event.detail.start;

      // Make a request and show the resulting suggestions
      request = fakejax('/api/suggestions', { query: userInput, start: startRecord }, function(suggestions) {
        autocomplete.addSuggestions(suggestions);
      });
    });

    autocomplete.on('coral-autocomplete:hidesuggestions', function() {
      // If the suggestions were hidden, abort the request
      if (request) {
        request.abort();
      }
    });
  </script>
</body>
</html>
