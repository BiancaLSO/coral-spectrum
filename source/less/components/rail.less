/**
  Class: div.rail
  The side rail for pages
*/
div.rail {
  max-width: 35%;

  background-color: @rail-background-color;

  @pull-to-request-size: 3rem;

  // if pull to request is possible, then the background needs to transparent
  &.pullable {
    position: relative;
    background-color: transparent; 

    >.pull-to-refresh {
      display: block;
    }   

    >.wrap {
      padding-bottom: 1px; // this is necessary to enable scrolling
    }
  }

  // Add shadow to left/right rail
  &.left {
    .box-shadow(inset -1*@rail-shadow-distance 0 @rail-shadow-spread rgba(0, 0, 0, @rail-shadow-opacity)); // TBD: make sure this matches mocks...
    float: left;
  }

  &.right {
    .box-shadow(inset @rail-shadow-distance 0 @rail-shadow-spread rgba(0, 0, 0, @rail-shadow-opacity));
    float: right;
  }

  >div.pull-to-refresh {
    display: none;    

    line-height: @pull-to-request-size;
    height: @pull-to-request-size;
    width: 100%; 
    
    position: absolute; 
    left: 0; 
    top: -@pull-to-request-size;

    font-size: 0.85rem;

    z-index: -1; // push it backwards

    >.message {
        height: @pull-to-request-size;
        width: 100%;
        overflow-y: auto;
        position: relative;

        >i.spinner,
        >i.arrow {
          margin: 0.5rem 0.5rem 0.5rem 1rem;
          display: block;
        }

        >i.arrow { 
          display: inline-block;
          width: 1rem;
          height: 2rem;

          background-position: center center;
          background-image: url(~"@{component-images-folder}/rail/pull-to-refresh-arrow.png");

          .background-size(100%);
        }

        // positioning the messages as layers and hiding with opacity avoids flashing on iOS
        >span.pull,
        >span.release, 
        >span.loading {
          text-align: center;

          display: block;
          height: @pull-to-request-size;
          width: 100%;

          position: absolute;
          top: 0;
          left: 0;

          opacity: 0;
        }
    }
  }

  >.wrap {
    // activate hardware acceleration, 
    // otherwise the content gets scrambled while scrolling 
    // -> because the outer div is the scrolling div
    -webkit-transform: translateZ(0);

    // stretch to screen height
    min-height: 100%;

    // necessary of pull-to-refresh is possible
    background-color: @rail-background-color;

    section {
      margin: 0;
      padding: 0.5rem;

      border-top: @px solid @rail-section-border-color;
      box-shadow: inset 0 @px 0 @rail-section-highlight-color;

      color: @rail-font-color;

      &:first-child { // First section does not have border/highlight
        border-top: none;
        box-shadow: none;
      }

      // For no styling
      &.bare {
        box-shadow: none;
        border-top: none;
      }

      // For no padding
      &.thin {
        padding: 0;
      }

      &.links {
        padding: 0.25rem 0;

        a {
          text-decoration: none;

          display: block;

          &:active {
            background-color: @rail-well-background-color;
          }
        }

        // TBD: fix margin collapse for strong
        >h4,
        >a.heading {
          font-weight: bold;
          margin: 0 0 0.15rem 0;

          font-size: 0.95rem;

          color: @rail-font-color;

          padding: 0.25rem 0.7rem;
        }

        >nav {
          >a {
            padding: 0.35rem 1.5rem;

            font-size: 0.85rem;
            //text-shadow: 0 2*@px 0 black;
            color: @rail-section-link-color;
          }
        }
      }

      // the section is foldable
      &.foldable {
        >.heading:before {
          content: "\25B8";
          padding-right: 0.5rem;  
        }

        >.fold {
          height: 0;
          overflow: hidden;
        }

        &.open {
          >.fold {
            height: auto;
            overflow: auto;
          }

          >.heading:before {
            content: "\25BE";
          }
        }
      }

      // the section should be on the bottom of the rail
      &.fixed {
        position: fixed;
        bottom: 0;
      }
    }
  }
}
