/**
* 
* A calendar for picking dates
*/

.datepicker {
    display: inline-block;
    margin: 0.125rem 0;  // Give a top/bottom margin so they stack right
    position: relative;
    font-size: 0; /* Remove space between inline-block elements */

    &.focus > button,
    &.focus input {
      .glow();
    }
    &.error > button,
    &.error input {
      .glow(0.357rem, @textfield-error-border-color, @textfield-error-border-color);
    }

    button {
      display: inline-block;
      vertical-align: middle;
      .border-box;
      margin: 0; // Reset default margin on button tag
      margin-left: -@px; // Overlap border
      padding: 0.4375rem 0.5rem 0.5rem;
      height: @dropdown-text-size+0.4375rem*2+@px*2;
      height: 2rem;
      min-width: 2rem;
      width: 2rem;
      border: @px solid @dropdown-border-color;
      background-size: 1.0rem 1.0rem;
      background: @dropdown-gradient-start-color;
      .gradient(@dropdown-gradient-start-color, @dropdown-gradient-end-color);
      font-family: @font-base-family;
      font-size: @dropdown-text-size;
      line-height: @dropdown-text-size;
      font-weight: normal;
      color: @dropdown-text-color;
      text-shadow: none;

      &:disabled {
        cursor: default;
        border-color: @button-disabled-border-color;
        color: @button-disabled-text-color;
        text-shadow: none;
        background: @button-disabled-background-color;

        span {
          .opacity(30);
        }
      }

      &:hover:not([disabled]) {
        border: @px solid @dropdown-border-color;
        background: @dropdown-gradient-start-color;
        .gradient(@dropdown-gradient-start-color, @dropdown-gradient-start-color);
      }

      &:active:not([disabled]) {
        border: @px solid @dropdown-border-color;
        background: @dropdown-gradient-end-color;
        .gradient(@dropdown-gradient-end-color, @dropdown-gradient-end-color);
        .box-shadow(inset 0 0 0.5rem rgba(0, 0, 0, 0.25));
      }
    }

    .datepicker-calendar {
      position: absolute;
      display: block;
      top: 3rem; /* 48px */ /* TODO: place popover relative to the action button (above or below) */
      left: 0;
      width: 244*@px;
      border: 10*@px solid @popover-border-color; /* TODO: 8px in .popover, but design shows 10px */

      /* TODO: this is an override of popover .arrow-top. Increases margin to 10px to match design document
       * should margins consistently be 8px or 10px for popovers, change accordingly.
       */
      &.arrow-top:before {
        margin-bottom: 10*@px;
      }

      /* TODO: Adapted from .modal-header. This should be handled by the popover and make use of variables */
      .popover-header {
        position: relative;
        .border-box;
        width: 100%;
        height: @modal-header-height;
        background: @modal-header-background-color;
        border: @px solid @modal-outline-color;
        border-bottom: 0;

        // Bottom border, easiest with a box shadow
        .box-shadow(inset 0 -@px 0 @modal-header-border-color);

        h2 {
          position: absolute;
          left: 0;
          top: 0;
          text-align: center;
          font-size: 20*@px;
          .border-box;
          width: 100%;
          height: 3.125rem;
          margin: 0;
          padding: 0;
          line-height: 3.125rem;
          .ellipsis();
        }

        button.prev-month,
        button.next-month {
          position: absolute;
          top: 0;
          color: rgb(90,90,90);
          padding: 4*@px;
          margin: 8*@px;
          font-size: 26*@px;
          line-height: 26*@px;
          border: 0;
          background: none;
          filter: progid:DXImageTransform.Microsoft.gradient(enabled = false); /* Remove ie filter */
          width: auto;
          height: auto;

          &:hover {
            border: 0 none;
            background: none;
            color: rgb(44,44,44);
          }

          &:active, &:focus {
            background: none;
            .box-shadow(none);
          }
        }

        button.prev-month {
          left: 0;
          margin-left: 5*@px;
        }
        button.next-month {
          right: 0;
          margin-right: 5*@px;
        }
      }

      // TODO: taken from .modal-body for styling. Should belong to popover
      .popover-body {
        .border-box;
        width: 100%;
        padding: 0;
        .scrollable();
        border: @px solid @modal-outline-color;
        border-top: 0;
      }

      table {
        table-layout: fixed;
        border-spacing: @px;
        width: 100%;
        margin: 0;
        background-color: rgb(230,230,230);
        font-size: 15*@px;
        font-family: AdobeCleanLight;

        a, span {
          background: @datepicker-day-background-color;
          padding: 7*@px 0;
          display: block;
        }

        th, td {
          text-align: center;
          padding: 0;

          &:first-child {
            a, span {
              margin-left: -@px;
            }
            a:active, &.datepicker-day-selected a, &.datepicker-today a, &.datepicker-today a:active {
              border-left: 0 none;
            }
          }

          &:last-child {
            a, span {
              margin-right: -@px;
            }
            a:active, &.datepicker-day-selected a, &.datepicker-today a, &.datepicker-today a:active {
              border-right: 0 none;
            }
          }
        }

        tr:last-child {
          a, span {
            margin-bottom: -@px;
          }
          a:active, .datepicker-day-selected a, .datepicker-today a, .datepicker-today a:active {
            border-bottom: 0 none;
          }
        }

        th {
          span {
            background: @datepicker-day-title-background-color;
            border-bottom: @px solid @datepicker-day-title-border-color;
            font-size: 10*@px;
            text-transform: uppercase;
            padding: 3*@px 0;
            margin: -@px;
          }
        }

        td {
          a {
            color: @datepicker-day;
            text-decoration: none;
            position: relative;
            z-index: 100;

            &:hover {
              text-decoration: none;
              background: @datepicker-day-hover-background-color;
            }

            &:focus {
              .box-shadow(none);
            }
          }

          span {
            background: @datepicker-day-dimmed-background-color;
            color: @datepicker-day-dimmed-text-color;
          }

          &.datepicker-today {
            a {
              margin: -@px;
              background: @datepicker-day-today-background-color;
              border: @px solid @datepicker-day-today-border-color;
            }
          }

          // Pressed, selected
          a:active, &.datepicker-today a:active, &.datepicker-day-selected a {
            margin: -@px;
            border: @px solid @datepicker-day-selected-border-color;
            background: @datepicker-day-selected-background-color;
            color: @datepicker-day-selected-text-color;
            z-index: 200;
          }
        }
      }
    }
}
