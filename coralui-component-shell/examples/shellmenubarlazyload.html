<!DOCTYPE html>
<html>
<head>
  <title>CoralUI 3 Shell</title>
  <link rel="stylesheet" href="../build/css/coral.css">
  <script src="../build/js/coral.js"></script>

  <style>
    .example-shell {
      position: absolute;
      top: 0;
      right: 0;
      left: 0;
      bottom: 0;
    }

    .example-header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;

      box-sizing: border-box;
      padding: 0.375rem;
      height: 3.25rem;

      z-index: 9999999;

      background: black;

      text-align: right;
    }

    .widget {
      min-width: 10rem;
      min-height: 10rem;
    }

    #menu_solutions {
      color: white;
    }
  </style>
</head>
<body>

<div class="example-shell">

  <div class="coral--dark example-header">
    <coral-shell-menubar>
      <coral-shell-menubar-item menu="#menu_lazy" icon="helpCircle"></coral-shell-menubar-item>
    </coral-shell-menubar>
  </div>

  <coral-shell-menu id="menu_lazy"></coral-shell-menu>

</div>

<script>
  var NOTLOADED = -1;
  var LOADING = 0;
  var LOADED = 1;

  // The state of our lazyloader
  var contentsLoaded = NOTLOADED;

  // Get a reference to the menu
  var menu = document.querySelector('#menu_lazy');
  // Add a listener for the beforeopen event
  menu.addEventListener('coral-overlay:beforeopen', function(event) {
    console.log('contentsLoaded: ', contentsLoaded);
    if (contentsLoaded !== LOADED) {
      // Stop the menu from opening (optional)
      event.preventDefault();
    }

    if (contentsLoaded === NOTLOADED) {
      // Mark that content is currently being loaded
      contentsLoaded = LOADING;

      // Lazy-load the menu contents
      setTimeout(function() {
        console.log('Loaded content!');

        // Set contents
        menu.innerHTML = 'Content!';

        // Mark that contents have been loaded
        contentsLoaded = LOADED;

        // Open the menu
        menu.open = true;
      }, 500);
    }
  });
</script>

</body>
</html>
